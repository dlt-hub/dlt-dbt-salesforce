/* Fact Table: event */


SELECT
    ---- main table event
    event._dlt_id,
    event.id,
    event.who_id,
    event.what_id,
    event.subject,
    event.location,
    event.is_all_day_event,
    event.activity_date_time,
    event.activity_date,
    event.duration_in_minutes,
    event.start_date_time,
    event.end_date_time,
    event.end_date,
    event.account_id,
    event.owner_id,
    event.is_private,
    event.show_as,
    event.is_deleted,
    event.is_child,
    event.is_group_event,
    event.created_date,
    event.created_by_id,
    event.last_modified_date,
    event.last_modified_by_id,
    event.system_modstamp,
    event.is_archived,
    event.is_recurrence,
    event.is_reminder_set,
    event.event_subtype,
    event.is_recurrence2_exclusion,
    event.is_recurrence2,
    event.is_recurrence2_exception,
    event.description,

    
    ---- dim table sf_user via sf_user__owner_id
    sf_user__owner_id.id as sf_user__owner_id__id,
    -- sf_user__owner_id.username as sf_user__owner_id__username,
    -- sf_user__owner_id.last_name as sf_user__owner_id__last_name,
    -- sf_user__owner_id.first_name as sf_user__owner_id__first_name,
    -- sf_user__owner_id.name as sf_user__owner_id__name,
    -- sf_user__owner_id.company_name as sf_user__owner_id__company_name,
    -- sf_user__owner_id.country as sf_user__owner_id__country,
    -- sf_user__owner_id.email as sf_user__owner_id__email,
    -- sf_user__owner_id.email_preferences_auto_bcc as sf_user__owner_id__email_preferences_auto_bcc,
    -- sf_user__owner_id.email_preferences_auto_bcc_stay_in_touch as sf_user__owner_id__email_preferences_auto_bcc_stay_in_touch,
    -- sf_user__owner_id.email_preferences_stay_in_touch_reminder as sf_user__owner_id__email_preferences_stay_in_touch_reminder,
    -- sf_user__owner_id.alias as sf_user__owner_id__alias,
    -- sf_user__owner_id.community_nickname as sf_user__owner_id__community_nickname,
    -- sf_user__owner_id.badge_text as sf_user__owner_id__badge_text,
    -- sf_user__owner_id.is_active as sf_user__owner_id__is_active,
    -- sf_user__owner_id.time_zone_sid_key as sf_user__owner_id__time_zone_sid_key,
    -- sf_user__owner_id.locale_sid_key as sf_user__owner_id__locale_sid_key,
    -- sf_user__owner_id.receives_info_emails as sf_user__owner_id__receives_info_emails,
    -- sf_user__owner_id.receives_admin_info_emails as sf_user__owner_id__receives_admin_info_emails,
    -- sf_user__owner_id.email_encoding_key as sf_user__owner_id__email_encoding_key,
    -- sf_user__owner_id.profile_id as sf_user__owner_id__profile_id,
    -- sf_user__owner_id.user_type as sf_user__owner_id__user_type,
    -- sf_user__owner_id.language_locale_key as sf_user__owner_id__language_locale_key,
    -- sf_user__owner_id.last_login_date as sf_user__owner_id__last_login_date,
    -- sf_user__owner_id.last_password_change_date as sf_user__owner_id__last_password_change_date,
    -- sf_user__owner_id.created_date as sf_user__owner_id__created_date,
    -- sf_user__owner_id.created_by_id as sf_user__owner_id__created_by_id,
    -- sf_user__owner_id.last_modified_date as sf_user__owner_id__last_modified_date,
    -- sf_user__owner_id.last_modified_by_id as sf_user__owner_id__last_modified_by_id,
    -- sf_user__owner_id.system_modstamp as sf_user__owner_id__system_modstamp,
    -- sf_user__owner_id.number_of_failed_logins as sf_user__owner_id__number_of_failed_logins,
    -- sf_user__owner_id.user_permissions_marketing_user as sf_user__owner_id__user_permissions_marketing_user,
    -- sf_user__owner_id.user_permissions_offline_user as sf_user__owner_id__user_permissions_offline_user,
    -- sf_user__owner_id.user_permissions_call_center_auto_login as sf_user__owner_id__user_permissions_call_center_auto_login,
    -- sf_user__owner_id.user_permissions_sf_content_user as sf_user__owner_id__user_permissions_sf_content_user,
    -- sf_user__owner_id.user_permissions_knowledge_user as sf_user__owner_id__user_permissions_knowledge_user,
    -- sf_user__owner_id.user_permissions_interaction_user as sf_user__owner_id__user_permissions_interaction_user,
    -- sf_user__owner_id.user_permissions_support_user as sf_user__owner_id__user_permissions_support_user,
    -- sf_user__owner_id.user_permissions_jigsaw_prospecting_user as sf_user__owner_id__user_permissions_jigsaw_prospecting_user,
    -- sf_user__owner_id.user_permissions_siteforce_contributor_user as sf_user__owner_id__user_permissions_siteforce_contributor_user,
    -- sf_user__owner_id.user_permissions_siteforce_publisher_user as sf_user__owner_id__user_permissions_siteforce_publisher_user,
    -- sf_user__owner_id.user_permissions_work_dot_com_user_feature as sf_user__owner_id__user_permissions_work_dot_com_user_feature,
    -- sf_user__owner_id.forecast_enabled as sf_user__owner_id__forecast_enabled,
    -- sf_user__owner_id.user_preferences_activity_reminders_popup as sf_user__owner_id__user_preferences_activity_reminders_popup,
    -- sf_user__owner_id.user_preferences_event_reminders_checkbox_default as sf_user__owner_id__user_preferences_event_reminders_checkbox_default,
    -- sf_user__owner_id.user_preferences_task_reminders_checkbox_default as sf_user__owner_id__user_preferences_task_reminders_checkbox_default,
    -- sf_user__owner_id.user_preferences_reminder_sound_off as sf_user__owner_id__user_preferences_reminder_sound_off,
    -- sf_user__owner_id.user_preferences_disable_all_feeds_email as sf_user__owner_id__user_preferences_disable_all_feeds_email,
    -- sf_user__owner_id.user_preferences_disable_followers_email as sf_user__owner_id__user_preferences_disable_followers_email,
    -- sf_user__owner_id.user_preferences_disable_profile_post_email as sf_user__owner_id__user_preferences_disable_profile_post_email,
    -- sf_user__owner_id.user_preferences_disable_change_comment_email as sf_user__owner_id__user_preferences_disable_change_comment_email,
    -- sf_user__owner_id.user_preferences_disable_later_comment_email as sf_user__owner_id__user_preferences_disable_later_comment_email,
    -- sf_user__owner_id.user_preferences_dis_prof_post_comment_email as sf_user__owner_id__user_preferences_dis_prof_post_comment_email,
    -- sf_user__owner_id.user_preferences_content_no_email as sf_user__owner_id__user_preferences_content_no_email,
    -- sf_user__owner_id.user_preferences_content_email_as_and_when as sf_user__owner_id__user_preferences_content_email_as_and_when,
    -- sf_user__owner_id.user_preferences_apex_pages_developer_mode as sf_user__owner_id__user_preferences_apex_pages_developer_mode,
    -- sf_user__owner_id.user_preferences_receive_no_notifications_as_approver as sf_user__owner_id__user_preferences_receive_no_notifications_as_approver,
    -- sf_user__owner_id.user_preferences_receive_notifications_as_delegated_approver as sf_user__owner_id__user_preferences_receive_notifications_as_delegated_approver,
    -- sf_user__owner_id.user_preferences_hide_csn_get_chatter_mobile_task as sf_user__owner_id__user_preferences_hide_csn_get_chatter_mobile_task,
    -- sf_user__owner_id.user_preferences_disable_mentions_post_email as sf_user__owner_id__user_preferences_disable_mentions_post_email,
    -- sf_user__owner_id.user_preferences_dis_mentions_comment_email as sf_user__owner_id__user_preferences_dis_mentions_comment_email,
    -- sf_user__owner_id.user_preferences_hide_csn_desktop_task as sf_user__owner_id__user_preferences_hide_csn_desktop_task,
    -- sf_user__owner_id.user_preferences_hide_chatter_onboarding_splash as sf_user__owner_id__user_preferences_hide_chatter_onboarding_splash,
    -- sf_user__owner_id.user_preferences_hide_second_chatter_onboarding_splash as sf_user__owner_id__user_preferences_hide_second_chatter_onboarding_splash,
    -- sf_user__owner_id.user_preferences_dis_comment_after_like_email as sf_user__owner_id__user_preferences_dis_comment_after_like_email,
    -- sf_user__owner_id.user_preferences_disable_like_email as sf_user__owner_id__user_preferences_disable_like_email,
    -- sf_user__owner_id.user_preferences_sort_feed_by_comment as sf_user__owner_id__user_preferences_sort_feed_by_comment,
    -- sf_user__owner_id.user_preferences_disable_message_email as sf_user__owner_id__user_preferences_disable_message_email,
    -- sf_user__owner_id.user_preferences_jigsaw_list_user as sf_user__owner_id__user_preferences_jigsaw_list_user,
    -- sf_user__owner_id.user_preferences_disable_bookmark_email as sf_user__owner_id__user_preferences_disable_bookmark_email,
    -- sf_user__owner_id.user_preferences_disable_share_post_email as sf_user__owner_id__user_preferences_disable_share_post_email,
    -- sf_user__owner_id.user_preferences_enable_auto_sub_for_feeds as sf_user__owner_id__user_preferences_enable_auto_sub_for_feeds,
    -- sf_user__owner_id.user_preferences_disable_file_share_notifications_for_api as sf_user__owner_id__user_preferences_disable_file_share_notifications_for_api,
    -- sf_user__owner_id.user_preferences_show_title_to_external_users as sf_user__owner_id__user_preferences_show_title_to_external_users,
    -- sf_user__owner_id.user_preferences_show_manager_to_external_users as sf_user__owner_id__user_preferences_show_manager_to_external_users,
    -- sf_user__owner_id.user_preferences_show_email_to_external_users as sf_user__owner_id__user_preferences_show_email_to_external_users,
    -- sf_user__owner_id.user_preferences_show_work_phone_to_external_users as sf_user__owner_id__user_preferences_show_work_phone_to_external_users,
    -- sf_user__owner_id.user_preferences_show_mobile_phone_to_external_users as sf_user__owner_id__user_preferences_show_mobile_phone_to_external_users,
    -- sf_user__owner_id.user_preferences_show_fax_to_external_users as sf_user__owner_id__user_preferences_show_fax_to_external_users,
    -- sf_user__owner_id.user_preferences_show_street_address_to_external_users as sf_user__owner_id__user_preferences_show_street_address_to_external_users,
    -- sf_user__owner_id.user_preferences_show_city_to_external_users as sf_user__owner_id__user_preferences_show_city_to_external_users,
    -- sf_user__owner_id.user_preferences_show_state_to_external_users as sf_user__owner_id__user_preferences_show_state_to_external_users,
    -- sf_user__owner_id.user_preferences_show_postal_code_to_external_users as sf_user__owner_id__user_preferences_show_postal_code_to_external_users,
    -- sf_user__owner_id.user_preferences_show_country_to_external_users as sf_user__owner_id__user_preferences_show_country_to_external_users,
    -- sf_user__owner_id.user_preferences_show_profile_pic_to_guest_users as sf_user__owner_id__user_preferences_show_profile_pic_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_title_to_guest_users as sf_user__owner_id__user_preferences_show_title_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_city_to_guest_users as sf_user__owner_id__user_preferences_show_city_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_state_to_guest_users as sf_user__owner_id__user_preferences_show_state_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_postal_code_to_guest_users as sf_user__owner_id__user_preferences_show_postal_code_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_country_to_guest_users as sf_user__owner_id__user_preferences_show_country_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_forecasting_change_signals as sf_user__owner_id__user_preferences_show_forecasting_change_signals,
    -- sf_user__owner_id.user_preferences_live_agent_miaw_setup_deflection as sf_user__owner_id__user_preferences_live_agent_miaw_setup_deflection,
    -- sf_user__owner_id.user_preferences_hide_s1_browser_ui as sf_user__owner_id__user_preferences_hide_s1_browser_ui,
    -- sf_user__owner_id.user_preferences_disable_endorsement_email as sf_user__owner_id__user_preferences_disable_endorsement_email,
    -- sf_user__owner_id.user_preferences_path_assistant_collapsed as sf_user__owner_id__user_preferences_path_assistant_collapsed,
    -- sf_user__owner_id.user_preferences_cache_diagnostics as sf_user__owner_id__user_preferences_cache_diagnostics,
    -- sf_user__owner_id.user_preferences_show_email_to_guest_users as sf_user__owner_id__user_preferences_show_email_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_manager_to_guest_users as sf_user__owner_id__user_preferences_show_manager_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_work_phone_to_guest_users as sf_user__owner_id__user_preferences_show_work_phone_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_mobile_phone_to_guest_users as sf_user__owner_id__user_preferences_show_mobile_phone_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_fax_to_guest_users as sf_user__owner_id__user_preferences_show_fax_to_guest_users,
    -- sf_user__owner_id.user_preferences_show_street_address_to_guest_users as sf_user__owner_id__user_preferences_show_street_address_to_guest_users,
    -- sf_user__owner_id.user_preferences_lightning_experience_preferred as sf_user__owner_id__user_preferences_lightning_experience_preferred,
    -- sf_user__owner_id.user_preferences_preview_lightning as sf_user__owner_id__user_preferences_preview_lightning,
    -- sf_user__owner_id.user_preferences_hide_end_user_onboarding_assistant_modal as sf_user__owner_id__user_preferences_hide_end_user_onboarding_assistant_modal,
    -- sf_user__owner_id.user_preferences_hide_lightning_migration_modal as sf_user__owner_id__user_preferences_hide_lightning_migration_modal,
    -- sf_user__owner_id.user_preferences_hide_sfx_welcome_mat as sf_user__owner_id__user_preferences_hide_sfx_welcome_mat,
    -- sf_user__owner_id.user_preferences_hide_bigger_photo_callout as sf_user__owner_id__user_preferences_hide_bigger_photo_callout,
    -- sf_user__owner_id.user_preferences_global_nav_bar_wt_shown as sf_user__owner_id__user_preferences_global_nav_bar_wt_shown,
    -- sf_user__owner_id.user_preferences_global_nav_grid_menu_wt_shown as sf_user__owner_id__user_preferences_global_nav_grid_menu_wt_shown,
    -- sf_user__owner_id.user_preferences_create_lex_apps_wt_shown as sf_user__owner_id__user_preferences_create_lex_apps_wt_shown,
    -- sf_user__owner_id.user_preferences_favorites_wt_shown as sf_user__owner_id__user_preferences_favorites_wt_shown,
    -- sf_user__owner_id.user_preferences_record_home_section_collapse_wt_shown as sf_user__owner_id__user_preferences_record_home_section_collapse_wt_shown,
    -- sf_user__owner_id.user_preferences_record_home_reserved_wt_shown as sf_user__owner_id__user_preferences_record_home_reserved_wt_shown,
    -- sf_user__owner_id.user_preferences_favorites_show_top_favorites as sf_user__owner_id__user_preferences_favorites_show_top_favorites,
    -- sf_user__owner_id.user_preferences_exclude_mail_app_attachments as sf_user__owner_id__user_preferences_exclude_mail_app_attachments,
    -- sf_user__owner_id.user_preferences_suppress_task_sfx_reminders as sf_user__owner_id__user_preferences_suppress_task_sfx_reminders,
    -- sf_user__owner_id.user_preferences_suppress_event_sfx_reminders as sf_user__owner_id__user_preferences_suppress_event_sfx_reminders,
    -- sf_user__owner_id.user_preferences_preview_custom_theme as sf_user__owner_id__user_preferences_preview_custom_theme,
    -- sf_user__owner_id.user_preferences_has_celebration_badge as sf_user__owner_id__user_preferences_has_celebration_badge,
    -- sf_user__owner_id.user_preferences_user_debug_mode_pref as sf_user__owner_id__user_preferences_user_debug_mode_pref,
    -- sf_user__owner_id.user_preferences_srh_override_activities as sf_user__owner_id__user_preferences_srh_override_activities,
    -- sf_user__owner_id.user_preferences_new_lightning_report_run_page_enabled as sf_user__owner_id__user_preferences_new_lightning_report_run_page_enabled,
    -- sf_user__owner_id.user_preferences_reverse_open_activities_view as sf_user__owner_id__user_preferences_reverse_open_activities_view,
    -- sf_user__owner_id.user_preferences_show_territory_time_zone_shifts as sf_user__owner_id__user_preferences_show_territory_time_zone_shifts,
    -- sf_user__owner_id.user_preferences_has_sent_warning_email as sf_user__owner_id__user_preferences_has_sent_warning_email,
    -- sf_user__owner_id.user_preferences_has_sent_warning_email238 as sf_user__owner_id__user_preferences_has_sent_warning_email238,
    -- sf_user__owner_id.user_preferences_has_sent_warning_email240 as sf_user__owner_id__user_preferences_has_sent_warning_email240,
    -- sf_user__owner_id.user_preferences_native_email_client as sf_user__owner_id__user_preferences_native_email_client,
    -- sf_user__owner_id.user_preferences_show_forecasting_rounded_amounts as sf_user__owner_id__user_preferences_show_forecasting_rounded_amounts,
    -- sf_user__owner_id.full_photo_url as sf_user__owner_id__full_photo_url,
    -- sf_user__owner_id.small_photo_url as sf_user__owner_id__small_photo_url,
    -- sf_user__owner_id.is_ext_indicator_visible as sf_user__owner_id__is_ext_indicator_visible,
    -- sf_user__owner_id.out_of_office_message as sf_user__owner_id__out_of_office_message,
    -- sf_user__owner_id.medium_photo_url as sf_user__owner_id__medium_photo_url,
    -- sf_user__owner_id.digest_frequency as sf_user__owner_id__digest_frequency,
    -- sf_user__owner_id.default_group_notification_frequency as sf_user__owner_id__default_group_notification_frequency,
    -- sf_user__owner_id.jigsaw_import_limit_override as sf_user__owner_id__jigsaw_import_limit_override,
    -- sf_user__owner_id.last_viewed_date as sf_user__owner_id__last_viewed_date,
    -- sf_user__owner_id.last_referenced_date as sf_user__owner_id__last_referenced_date,
    -- sf_user__owner_id.banner_photo_url as sf_user__owner_id__banner_photo_url,
    -- sf_user__owner_id.small_banner_photo_url as sf_user__owner_id__small_banner_photo_url,
    -- sf_user__owner_id.medium_banner_photo_url as sf_user__owner_id__medium_banner_photo_url,
    -- sf_user__owner_id.is_profile_photo_active as sf_user__owner_id__is_profile_photo_active,
    -- sf_user__owner_id.sender_name as sf_user__owner_id__sender_name,
    -- sf_user__owner_id.about_me as sf_user__owner_id__about_me,
    

FROM  `dlthub-analytics`.`salesforce_data_tst9_20240930010342_transformed`.`stg_event` as event
LEFT JOIN `dlthub-analytics`.`salesforce_data_tst9_20240930010342_transformed`.`dim_sf_user` as sf_user__owner_id ON
        sf_user__owner_id.id = event.owner_id